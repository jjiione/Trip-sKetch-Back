<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssafy.bonvoyageh.repository.place.PlaceDao">

    <select id="searchKeyword" parameterType="String" resultType="PlaceDto">
        select content_id, sido_code, gugun_code, latitude, longitude, content_type_id, title
        from places
        where title like concat('%', #{word}, '%')
        order by title limit 20
    </select>



    <select id="searchDetail" parameterType="int" resultType="ContentType12_AttractionDto">
        select *
        from attraction_detail_content_type_12
        where contentid = #{placeId}
    </select>

    <select id="placeImages" parameterType="int" resultType="String">
        select img_src
        from place_images
        where content_id = #{placeId}
    </select>


    <select id="currentReview" resultType="ReviewShowDto">
        select r.place_id, r.create_time, r.content, r.rate, r.user_id, p.title
        from reviews r join places p
                            on r.place_id = p.content_id
        order by create_time desc limit 6
    </select>

    <insert id="writeReview" parameterType="ReviewDto">
        insert into reviews (place_id, content, rate)
        values ( #{placeId}, #{content}, #{rate})
    </insert>





</mapper>